=== RUN   TestDebugBaseIPRF
Testing base iPRF with n=1000, m=100
✅ Base: Forward(29) = 3, Inverse(3) contains 29 (len=14)
✅ Base: Forward(35) = 3, Inverse(3) contains 35 (len=14)
✅ Base: Forward(42) = 4, Inverse(4) contains 42 (len=17)
✅ Base: Forward(44) = 4, Inverse(4) contains 44 (len=17)
✅ Base: Forward(47) = 4, Inverse(4) contains 47 (len=17)
✅ Base: Forward(54) = 4, Inverse(4) contains 54 (len=17)
✅ Base: Forward(55) = 4, Inverse(4) contains 55 (len=17)
✅ Base: Forward(56) = 4, Inverse(4) contains 56 (len=17)
✅ Base: Forward(57) = 5, Inverse(5) contains 57 (len=10)
--- PASS: TestDebugBaseIPRF (0.00s)
=== RUN   TestDebugDeterministic
    debug_deterministic_test.go:39: ✅ Forward(47) = 97, Inverse(97) contains 47
    debug_deterministic_test.go:39: ✅ Forward(74) = 90, Inverse(90) contains 74
    debug_deterministic_test.go:39: ✅ Forward(75) = 51, Inverse(51) contains 75
    debug_deterministic_test.go:39: ✅ Forward(83) = 2, Inverse(2) contains 83
    debug_deterministic_test.go:39: ✅ Forward(95) = 39, Inverse(39) contains 95
    debug_deterministic_test.go:39: ✅ Forward(97) = 39, Inverse(39) contains 97
--- PASS: TestDebugDeterministic (0.00s)
=== RUN   TestDebugEnhancedIPRF
Base iPRF: Forward(5) = 0, Inverse(0) = 9 preimages
Enhanced iPRF: Forward(5) = 5, Inverse(5) = 17 preimages
✅ Original index 5 found in enhanced inverse result
✅ Enhanced iPRF produces different result from base (PRP layer working)
--- PASS: TestDebugEnhancedIPRF (0.00s)
=== RUN   TestDebugPRPIssue
Testing BASE iPRF (without PRP layer):
✅ Base: Forward(0) = 0, Inverse(0) contains 0
✅ Base: Forward(1) = 0, Inverse(0) contains 1
✅ Base: Forward(2) = 0, Inverse(0) contains 2
✅ Base: Forward(3) = 0, Inverse(0) contains 3
✅ Base: Forward(4) = 0, Inverse(0) contains 4
✅ Base: Forward(5) = 0, Inverse(0) contains 5
✅ Base: Forward(6) = 0, Inverse(0) contains 6
✅ Base: Forward(7) = 0, Inverse(0) contains 7
✅ Base: Forward(8) = 0, Inverse(0) contains 8
✅ Base: Forward(9) = 0, Inverse(0) contains 9

Testing ENHANCED iPRF (with PRP layer):
✅ Enhanced: Forward(0) = 34, Inverse(34) contains 0
✅ Enhanced: Forward(1) = 35, Inverse(35) contains 1
✅ Enhanced: Forward(2) = 35, Inverse(35) contains 2
✅ Enhanced: Forward(3) = 6, Inverse(6) contains 3
✅ Enhanced: Forward(4) = 83, Inverse(83) contains 4
✅ Enhanced: Forward(5) = 71, Inverse(71) contains 5
✅ Enhanced: Forward(6) = 24, Inverse(24) contains 6
✅ Enhanced: Forward(7) = 76, Inverse(76) contains 7
✅ Enhanced: Forward(8) = 39, Inverse(39) contains 8
✅ Enhanced: Forward(9) = 36, Inverse(36) contains 9

Testing PRP layer directly:
✅ PRP: Permute(0) = 356, InversePermute(356) = 0
✅ PRP: Permute(1) = 366, InversePermute(366) = 1
✅ PRP: Permute(2) = 367, InversePermute(367) = 2
✅ PRP: Permute(3) = 66, InversePermute(66) = 3
✅ PRP: Permute(4) = 857, InversePermute(857) = 4
✅ PRP: Permute(5) = 746, InversePermute(746) = 5
✅ PRP: Permute(6) = 254, InversePermute(254) = 6
✅ PRP: Permute(7) = 786, InversePermute(786) = 7
✅ PRP: Permute(8) = 413, InversePermute(413) = 8
✅ PRP: Permute(9) = 374, InversePermute(374) = 9
--- PASS: TestDebugPRPIssue (0.00s)
=== RUN   TestDebugSpecificCase
Testing specific case: index 92
Forward(92) = 45
Inverse(45) found 12 preimages
✅ SUCCESS: Inverse(45) contains original index 92
--- PASS: TestDebugSpecificCase (0.00s)
=== RUN   TestDebugInverse
Forward(5) = 5
--- PASS: TestDebugInverse (0.00s)
=== RUN   TestDebugWithTestParams
Testing with n=1000, m=100, random keys
✅ Forward(0) = 68, Inverse(68) contains 0
✅ Forward(1) = 62, Inverse(62) contains 1
✅ Forward(2) = 27, Inverse(27) contains 2
✅ Forward(4) = 41, Inverse(41) contains 4
✅ Forward(6) = 20, Inverse(20) contains 6
✅ Forward(10) = 69, Inverse(69) contains 10
✅ Forward(11) = 4, Inverse(4) contains 11
✅ Forward(12) = 88, Inverse(88) contains 12
✅ Forward(13) = 13, Inverse(13) contains 13
--- PASS: TestDebugWithTestParams (0.00s)
=== RUN   TestEnhancedIPRF
    demo_main_test.go:36: ✅ Enhanced iPRF: Forward(1234) = 35, Inverse(35) contains 1234
    demo_main_test.go:42: Enhanced iPRF: Forward(1234) = 35, found 102 preimages
--- PASS: TestEnhancedIPRF (0.00s)
=== RUN   TestBug1InversePerformance
    iprf_bug1_test.go:35: InverseFixed completed in 167.125µs with 8242 preimages
    iprf_bug1_test.go:36: Expected preimage size: ~8203
--- PASS: TestBug1InversePerformance (0.00s)
=== RUN   TestBug1ComplexityScaling
    iprf_bug1_test.go:81: m=256: 53.875µs per inverse (k=3906)
    iprf_bug1_test.go:81: m=512: 50µs per inverse (k=1953)
    iprf_bug1_test.go:81: m=1024: 56.25µs per inverse (k=976)
    iprf_bug1_test.go:91: BUG #1: Larger m is slower - suggests O(n) brute force
    iprf_bug1_test.go:92: m=256: 53.875µs, m=1024: 56.25µs
--- FAIL: TestBug1ComplexityScaling (0.00s)
=== RUN   TestBug1InverseCorrectness
--- PASS: TestBug1InverseCorrectness (0.01s)
=== RUN   TestBug1TreeInverseAvailable
--- PASS: TestBug1TreeInverseAvailable (0.00s)
=== RUN   TestNewIPRFFromMasterSecret
    iprf_bug6_integration_test.go:31: ✓ NewIPRFFromMasterSecret produces consistent results
--- PASS: TestNewIPRFFromMasterSecret (0.00s)
=== RUN   TestKeyDerivationDeterminism
    iprf_bug6_integration_test.go:48: ✓ DeriveIPRFKey is deterministic
--- PASS: TestKeyDerivationDeterminism (0.00s)
=== RUN   TestContextSeparation
    iprf_bug6_integration_test.go:73: ✓ 4 different contexts produce 4 unique keys
--- PASS: TestContextSeparation (0.00s)
=== RUN   TestMasterSecretSeparation
    iprf_bug6_integration_test.go:98: ✓ 4 different master secrets produce 4 unique keys
--- PASS: TestMasterSecretSeparation (0.00s)
=== RUN   TestPersistenceScenario
    iprf_bug6_integration_test.go:110: Simulating initial server startup...
    iprf_bug6_integration_test.go:119: Cached: index 0 → hint 0
    iprf_bug6_integration_test.go:119: Cached: index 100000 → hint 12
    iprf_bug6_integration_test.go:119: Cached: index 1000000 → hint 122
    iprf_bug6_integration_test.go:119: Cached: index 5000000 → hint 609
    iprf_bug6_integration_test.go:119: Cached: index 8000000 → hint 975
    iprf_bug6_integration_test.go:123: Simulating server restart...
    iprf_bug6_integration_test.go:138: ✓ All cached hints remain valid after server restart
    iprf_bug6_integration_test.go:139: ✓ Key persistence working correctly in production scenario
--- PASS: TestPersistenceScenario (0.00s)
=== RUN   TestMultipleIPRFInstances
    iprf_bug6_integration_test.go:160: Index 12345 maps to:
    iprf_bug6_integration_test.go:161:   User hint: 1
    iprf_bug6_integration_test.go:162:   Transaction hint: 0
    iprf_bug6_integration_test.go:163:   State hint: 1
    iprf_bug6_integration_test.go:170: ✓ Multiple iPRF instances with different contexts work independently
--- PASS: TestMultipleIPRFInstances (0.00s)
=== RUN   TestBug6KeyPersistence
    iprf_bug6_test.go:45: ✓ iPRF behavior persists across restarts with deterministic key
    iprf_bug6_test.go:55: ✓ Random keys are different (would break persistence)
--- PASS: TestBug6KeyPersistence (0.00s)
=== RUN   TestBug6KeyDerivationNeeded
    iprf_bug6_test.go:79: ✓ DeriveIPRFKey implemented and working correctly
--- PASS: TestBug6KeyDerivationNeeded (0.00s)
=== RUN   TestBug6ProductionScenario
    iprf_bug6_test.go:103: Forward(0) = 0
    iprf_bug6_test.go:103: Forward(1000000) = 121
    iprf_bug6_test.go:103: Forward(5000000) = 609
    iprf_bug6_test.go:103: Forward(8000000) = 975
    iprf_bug6_test.go:120: ✓ Production scenario: iPRF persists across restarts
--- PASS: TestBug6ProductionScenario (0.00s)
=== RUN   TestBug6RandomKeyBreaksPersistence
    iprf_bug6_test.go:157: BUG #6 DEMONSTRATION: Random keys caused 20% of hints to change after restart
--- PASS: TestBug6RandomKeyBreaksPersistence (0.00s)
=== RUN   TestBug7NodeEncodingCollisions
    iprf_bug7_test.go:37: ✓ zero vs 2^16: No collision (11191237009979373250 vs 12081093159655623772)
    iprf_bug7_test.go:37: ✓ zero vs 2^17: No collision (11191237009979373250 vs 15137305948215597263)
    iprf_bug7_test.go:37: ✓ 1 vs 65537: No collision (7688800397571646729 vs 8653054239450077192)
    iprf_bug7_test.go:37: ✓ 1000 vs 66536: No collision (3464335103287750333 vs 7590084702180614527)
    iprf_bug7_test.go:37: ✓ production value collision: No collision (7997516479135716427 vs 8411481881962342144)
    iprf_bug7_test.go:37: ✓ multiple of 2^16: No collision (12081093159655623772 vs 15137305948215597263)
--- PASS: TestBug7NodeEncodingCollisions (0.00s)
=== RUN   TestBug7ProductionScenario
    iprf_bug7_test.go:90: ✓ No collisions found across 4092 unique node encodings
--- PASS: TestBug7ProductionScenario (0.00s)
=== RUN   TestBug7SpecificModuloPattern
    iprf_bug7_test.go:108: encodeNode(100, 200, 12345) = 9925732676706505490 (n & 0xFFFF = 12345)
    iprf_bug7_test.go:108: encodeNode(100, 200, 77881) = 14277954657731170643 (n & 0xFFFF = 12345)
    iprf_bug7_test.go:108: encodeNode(100, 200, 143417) = 9153625475261951543 (n & 0xFFFF = 12345)
    iprf_bug7_test.go:108: encodeNode(100, 200, 208953) = 10149817100189820764 (n & 0xFFFF = 12345)
    iprf_bug7_test.go:108: encodeNode(100, 200, 274489) = 15013177868920513574 (n & 0xFFFF = 12345)
--- PASS: TestBug7SpecificModuloPattern (0.00s)
=== RUN   TestEnhancedIPRFInverseSpace
=== RUN   TestEnhancedIPRFInverseSpace/small
=== RUN   TestEnhancedIPRFInverseSpace/small/preimages_in_original_space
=== RUN   TestEnhancedIPRFInverseSpace/small/not_in_permuted_space
=== RUN   TestEnhancedIPRFInverseSpace/small/forward-inverse_round_trip
=== RUN   TestEnhancedIPRFInverseSpace/medium
=== RUN   TestEnhancedIPRFInverseSpace/medium/preimages_in_original_space
=== RUN   TestEnhancedIPRFInverseSpace/medium/not_in_permuted_space
=== RUN   TestEnhancedIPRFInverseSpace/medium/forward-inverse_round_trip
=== RUN   TestEnhancedIPRFInverseSpace/large
=== RUN   TestEnhancedIPRFInverseSpace/large/preimages_in_original_space
=== RUN   TestEnhancedIPRFInverseSpace/large/not_in_permuted_space
=== RUN   TestEnhancedIPRFInverseSpace/large/forward-inverse_round_trip
--- PASS: TestEnhancedIPRFInverseSpace (0.02s)
    --- PASS: TestEnhancedIPRFInverseSpace/small (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/small/preimages_in_original_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/small/not_in_permuted_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/small/forward-inverse_round_trip (0.00s)
    --- PASS: TestEnhancedIPRFInverseSpace/medium (0.01s)
        --- PASS: TestEnhancedIPRFInverseSpace/medium/preimages_in_original_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/medium/not_in_permuted_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/medium/forward-inverse_round_trip (0.00s)
    --- PASS: TestEnhancedIPRFInverseSpace/large (0.01s)
        --- PASS: TestEnhancedIPRFInverseSpace/large/preimages_in_original_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/large/not_in_permuted_space (0.00s)
        --- PASS: TestEnhancedIPRFInverseSpace/large/forward-inverse_round_trip (0.01s)
=== RUN   TestEnhancedIPRFComposition
=== RUN   TestEnhancedIPRFComposition/forward_composition_correctness
=== RUN   TestEnhancedIPRFComposition/inverse_composition_correctness
--- PASS: TestEnhancedIPRFComposition (0.00s)
    --- PASS: TestEnhancedIPRFComposition/forward_composition_correctness (0.00s)
    --- PASS: TestEnhancedIPRFComposition/inverse_composition_correctness (0.00s)
=== RUN   TestEnhancedIPRFCorrectness
=== RUN   TestEnhancedIPRFCorrectness/complete_forward_mapping
=== RUN   TestEnhancedIPRFCorrectness/inverse_matches_forward
=== RUN   TestEnhancedIPRFCorrectness/bijection_on_domain
--- PASS: TestEnhancedIPRFCorrectness (0.00s)
    --- PASS: TestEnhancedIPRFCorrectness/complete_forward_mapping (0.00s)
    --- PASS: TestEnhancedIPRFCorrectness/inverse_matches_forward (0.00s)
    --- PASS: TestEnhancedIPRFCorrectness/bijection_on_domain (0.00s)
=== RUN   TestInverseVsInverseFixed
=== RUN   TestInverseVsInverseFixed/implementations_match
--- PASS: TestInverseVsInverseFixed (0.00s)
    --- PASS: TestInverseVsInverseFixed/implementations_match (0.00s)
=== RUN   TestEnhancedIPRFDeterminism
=== RUN   TestEnhancedIPRFDeterminism/same_keys_produce_same_results
=== RUN   TestEnhancedIPRFDeterminism/different_keys_produce_different_results
--- PASS: TestEnhancedIPRFDeterminism (0.00s)
    --- PASS: TestEnhancedIPRFDeterminism/same_keys_produce_same_results (0.00s)
    --- PASS: TestEnhancedIPRFDeterminism/different_keys_produce_different_results (0.00s)
=== RUN   TestEnhancedIPRFEdgeCases
=== RUN   TestEnhancedIPRFEdgeCases/n=m_case
    iprf_enhanced_test.go:473: Warning: Bin 27 has 6 elements (n=m case)
=== RUN   TestEnhancedIPRFEdgeCases/m=1_case
=== RUN   TestEnhancedIPRFEdgeCases/large_m/n_ratio
--- PASS: TestEnhancedIPRFEdgeCases (0.00s)
    --- PASS: TestEnhancedIPRFEdgeCases/n=m_case (0.00s)
    --- PASS: TestEnhancedIPRFEdgeCases/m=1_case (0.00s)
    --- PASS: TestEnhancedIPRFEdgeCases/large_m/n_ratio (0.00s)
=== RUN   TestCacheModeEffectiveness
=== RUN   TestCacheModeEffectiveness/cache_vs_no-cache_performance
    iprf_integration_test.go:68: No-cache duration: 5.194959ms
    iprf_integration_test.go:69: Cache duration: 114.208µs
    iprf_integration_test.go:70: Cache hits: 100, misses: 0
    iprf_integration_test.go:75: Speedup with cache: 45.49x
=== RUN   TestCacheModeEffectiveness/cache_correctness
--- PASS: TestCacheModeEffectiveness (0.01s)
    --- PASS: TestCacheModeEffectiveness/cache_vs_no-cache_performance (0.01s)
    --- PASS: TestCacheModeEffectiveness/cache_correctness (0.00s)
=== RUN   TestSystemIntegration
=== RUN   TestSystemIntegration/realistic_scale_forward
=== RUN   TestSystemIntegration/realistic_scale_inverse
    iprf_integration_test.go:164: Inverse(0): 8264 preimages in 587.292µs
    iprf_integration_test.go:164: Inverse(100): 8283 preimages in 582.541µs
    iprf_integration_test.go:164: Inverse(500): 8217 preimages in 573.417µs
    iprf_integration_test.go:164: Inverse(1000): 8176 preimages in 571.916µs
    iprf_integration_test.go:164: Inverse(1023): 8211 preimages in 571.083µs
=== RUN   TestSystemIntegration/expected_preimage_size
    iprf_integration_test.go:197: GetPreimageSize() = 8204, expected 8203
    iprf_integration_test.go:200: Expected preimage size: 8204 elements
--- FAIL: TestSystemIntegration (0.50s)
    --- PASS: TestSystemIntegration/realistic_scale_forward (0.49s)
    --- PASS: TestSystemIntegration/realistic_scale_inverse (0.00s)
    --- FAIL: TestSystemIntegration/expected_preimage_size (0.00s)
=== RUN   TestMultiQueryScenario
=== RUN   TestMultiQueryScenario/sequential_queries
    iprf_integration_test.go:247: Completed 50 queries with cache size 41
=== RUN   TestMultiQueryScenario/parallel_query_simulation
--- PASS: TestMultiQueryScenario (0.00s)
    --- PASS: TestMultiQueryScenario/sequential_queries (0.00s)
    --- PASS: TestMultiQueryScenario/parallel_query_simulation (0.00s)
=== RUN   TestBatchOperations
=== RUN   TestBatchOperations/batch_inverse_correctness
=== RUN   TestBatchOperations/batch_performance
    iprf_integration_test.go:328: Batch: 75µs, Sequential: 56.209µs
--- PASS: TestBatchOperations (0.00s)
    --- PASS: TestBatchOperations/batch_inverse_correctness (0.00s)
    --- PASS: TestBatchOperations/batch_performance (0.00s)
=== RUN   TestDistributionStats
=== RUN   TestDistributionStats/small_domain_stats
    iprf_integration_test.go:361: Distribution stats: map[actual_max_preimage:19 actual_median_preimage:10 actual_min_preimage:3 expected_preimage_size:10 total_outputs:100]
=== RUN   TestDistributionStats/large_domain_stats
    iprf_integration_test.go:383: Distribution stats: map[expected_preimage_size:100]
--- PASS: TestDistributionStats (0.00s)
    --- PASS: TestDistributionStats/small_domain_stats (0.00s)
    --- PASS: TestDistributionStats/large_domain_stats (0.00s)
=== RUN   TestErrorConditions
=== RUN   TestErrorConditions/out_of_range_queries
=== RUN   TestErrorConditions/boundary_queries
=== RUN   TestErrorConditions/forward_boundary_values
--- PASS: TestErrorConditions (0.00s)
    --- PASS: TestErrorConditions/out_of_range_queries (0.00s)
    --- PASS: TestErrorConditions/boundary_queries (0.00s)
    --- PASS: TestErrorConditions/forward_boundary_values (0.00s)
=== RUN   TestMemoryEfficiency
=== RUN   TestMemoryEfficiency/preimage_size_reasonable
--- PASS: TestMemoryEfficiency (0.03s)
    --- PASS: TestMemoryEfficiency/preimage_size_reasonable (0.03s)
=== RUN   TestConcurrentAccess
=== RUN   TestConcurrentAccess/determinism_under_repeated_access
--- PASS: TestConcurrentAccess (0.00s)
    --- PASS: TestConcurrentAccess/determinism_under_repeated_access (0.00s)
=== RUN   TestInversePerformanceComplexity
=== RUN   TestInversePerformanceComplexity/tiny_n=100
    iprf_performance_benchmark_test.go:59: Inverse(0): 13 preimages in 6.333µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 13 preimages in 2.167µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 13 preimages in 2.042µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 13 preimages in 2µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 13 preimages in 2.083µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=100: 2.925µs
=== RUN   TestInversePerformanceComplexity/small_n=1K
    iprf_performance_benchmark_test.go:59: Inverse(0): 18 preimages in 33.417µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 18 preimages in 2.708µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 18 preimages in 2.417µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 18 preimages in 2.583µs
    iprf_performance_benchmark_test.go:59: Inverse(0): 18 preimages in 2.5µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=1000: 8.725µs
=== RUN   TestInversePerformanceComplexity/medium_n=10K
    iprf_performance_benchmark_test.go:59: Inverse(0): 6 preimages in 282.542µs
    iprf_performance_benchmark_test.go:59: Inverse(100): 9 preimages in 2.334µs
    iprf_performance_benchmark_test.go:59: Inverse(200): 4 preimages in 1.917µs
    iprf_performance_benchmark_test.go:59: Inverse(300): 12 preimages in 2.5µs
    iprf_performance_benchmark_test.go:59: Inverse(400): 11 preimages in 2.541µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=10000: 58.366µs
=== RUN   TestInversePerformanceComplexity/large_n=100K
    iprf_performance_benchmark_test.go:59: Inverse(0): 90 preimages in 3.067583ms
    iprf_performance_benchmark_test.go:59: Inverse(100): 98 preimages in 6.958µs
    iprf_performance_benchmark_test.go:59: Inverse(200): 101 preimages in 6.5µs
    iprf_performance_benchmark_test.go:59: Inverse(300): 108 preimages in 7.667µs
    iprf_performance_benchmark_test.go:59: Inverse(400): 92 preimages in 6.542µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=100000: 619.05µs
=== RUN   TestInversePerformanceComplexity/realistic_n=1M
    iprf_performance_benchmark_test.go:59: Inverse(0): 968 preimages in 34.327708ms
    iprf_performance_benchmark_test.go:59: Inverse(100): 980 preimages in 74.125µs
    iprf_performance_benchmark_test.go:59: Inverse(200): 997 preimages in 70.75µs
    iprf_performance_benchmark_test.go:59: Inverse(300): 954 preimages in 74.417µs
    iprf_performance_benchmark_test.go:59: Inverse(400): 991 preimages in 70.208µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=1000000: 6.923441ms
=== RUN   TestInversePerformanceComplexity/full_scale_n=8.4M
    iprf_performance_benchmark_test.go:59: Inverse(0): 8264 preimages in 478.52975ms
    iprf_performance_benchmark_test.go:59: Inverse(100): 8283 preimages in 598.042µs
    iprf_performance_benchmark_test.go:59: Inverse(200): 8096 preimages in 587µs
    iprf_performance_benchmark_test.go:59: Inverse(300): 8201 preimages in 597.292µs
    iprf_performance_benchmark_test.go:59: Inverse(400): 8024 preimages in 569.417µs
    iprf_performance_benchmark_test.go:83: Average inverse time for n=8400000: 96.1763ms
--- PASS: TestInversePerformanceComplexity (0.52s)
    --- PASS: TestInversePerformanceComplexity/tiny_n=100 (0.00s)
    --- PASS: TestInversePerformanceComplexity/small_n=1K (0.00s)
    --- PASS: TestInversePerformanceComplexity/medium_n=10K (0.00s)
    --- PASS: TestInversePerformanceComplexity/large_n=100K (0.00s)
    --- PASS: TestInversePerformanceComplexity/realistic_n=1M (0.03s)
    --- PASS: TestInversePerformanceComplexity/full_scale_n=8.4M (0.48s)
=== RUN   TestPerformanceScaling
    iprf_performance_benchmark_test.go:122: n=1000: average inverse time = 5.154µs
    iprf_performance_benchmark_test.go:122: n=10000: average inverse time = 30.891µs
    iprf_performance_benchmark_test.go:122: n=100000: average inverse time = 310.625µs
    iprf_performance_benchmark_test.go:133: Size ratio 10.0x → Time ratio 5.99x
    iprf_performance_benchmark_test.go:146: Warning: Time scaling (5.99x) higher than expected (1.50x)
    iprf_performance_benchmark_test.go:133: Size ratio 10.0x → Time ratio 10.06x
    iprf_performance_benchmark_test.go:138: Performance scaling is linear or worse: size 10.0x → time 10.06x
    iprf_performance_benchmark_test.go:140: This indicates Bug 3: O(n) inverse complexity
    iprf_performance_benchmark_test.go:146: Warning: Time scaling (10.06x) higher than expected (1.50x)
--- FAIL: TestPerformanceScaling (0.00s)
=== RUN   TestPRPInversePerformance
=== RUN   TestPRPInversePerformance/small_n=1K
    iprf_performance_benchmark_test.go:193: n=1000: average PRP inverse time = 3.212µs
=== RUN   TestPRPInversePerformance/medium_n=10K
    iprf_performance_benchmark_test.go:193: n=10000: average PRP inverse time = 29.383µs
=== RUN   TestPRPInversePerformance/large_n=100K
    iprf_performance_benchmark_test.go:193: n=100000: average PRP inverse time = 307.85µs
=== RUN   TestPRPInversePerformance/realistic_n=1M
    iprf_performance_benchmark_test.go:193: n=1000000: average PRP inverse time = 3.338ms
--- PASS: TestPRPInversePerformance (0.04s)
    --- PASS: TestPRPInversePerformance/small_n=1K (0.00s)
    --- PASS: TestPRPInversePerformance/medium_n=10K (0.00s)
    --- PASS: TestPRPInversePerformance/large_n=100K (0.00s)
    --- PASS: TestPRPInversePerformance/realistic_n=1M (0.03s)
=== RUN   TestForwardPerformanceRealistic
=== RUN   TestForwardPerformanceRealistic/forward_latency
    iprf_performance_benchmark_test.go:320: Average forward latency: 480.691µs
    iprf_performance_benchmark_test.go:324: Forward too slow: 480.691µs (expected < 100µs)
=== RUN   TestForwardPerformanceRealistic/forward_throughput
    iprf_performance_benchmark_test.go:341: Forward throughput: 1012423 ops/sec
--- FAIL: TestForwardPerformanceRealistic (0.49s)
    --- FAIL: TestForwardPerformanceRealistic/forward_latency (0.48s)
    --- PASS: TestForwardPerformanceRealistic/forward_throughput (0.01s)
=== RUN   TestInversePerformanceRealistic
=== RUN   TestInversePerformanceRealistic/inverse_latency
    iprf_performance_benchmark_test.go:379: Inverse(0): 8264 preimages in 483.289625ms
    iprf_performance_benchmark_test.go:379: Inverse(100): 8283 preimages in 606.333µs
    iprf_performance_benchmark_test.go:379: Inverse(200): 8096 preimages in 568.333µs
    iprf_performance_benchmark_test.go:379: Inverse(300): 8201 preimages in 566µs
    iprf_performance_benchmark_test.go:379: Inverse(400): 8024 preimages in 547.833µs
    iprf_performance_benchmark_test.go:379: Inverse(500): 8217 preimages in 588.875µs
    iprf_performance_benchmark_test.go:379: Inverse(600): 8122 preimages in 564.209µs
    iprf_performance_benchmark_test.go:379: Inverse(700): 8162 preimages in 595µs
    iprf_performance_benchmark_test.go:379: Inverse(800): 8268 preimages in 600µs
    iprf_performance_benchmark_test.go:379: Inverse(900): 8243 preimages in 598.083µs
    iprf_performance_benchmark_test.go:401: Average inverse latency for n=8400000: 48.852429ms
--- PASS: TestInversePerformanceRealistic (0.49s)
    --- PASS: TestInversePerformanceRealistic/inverse_latency (0.49s)
=== RUN   TestMemoryUsageProfile
=== RUN   TestMemoryUsageProfile/n=1000
    iprf_performance_benchmark_test.go:436: n=1000: preimage size=18, estimated memory=144 bytes
=== RUN   TestMemoryUsageProfile/n=10000
    iprf_performance_benchmark_test.go:436: n=10000: preimage size=6, estimated memory=48 bytes
=== RUN   TestMemoryUsageProfile/n=100000
    iprf_performance_benchmark_test.go:436: n=100000: preimage size=90, estimated memory=720 bytes
=== RUN   TestMemoryUsageProfile/n=1000000
    iprf_performance_benchmark_test.go:436: n=1000000: preimage size=968, estimated memory=7744 bytes
--- PASS: TestMemoryUsageProfile (0.04s)
    --- PASS: TestMemoryUsageProfile/n=1000 (0.00s)
    --- PASS: TestMemoryUsageProfile/n=10000 (0.00s)
    --- PASS: TestMemoryUsageProfile/n=100000 (0.00s)
    --- PASS: TestMemoryUsageProfile/n=1000000 (0.03s)
=== RUN   TestWorstCasePerformance
=== RUN   TestWorstCasePerformance/smallest_range_m=1
    iprf_performance_benchmark_test.go:466: Worst case (m=1): 10000 preimages in 932.166µs
=== RUN   TestWorstCasePerformance/highly_skewed_distribution
    iprf_performance_benchmark_test.go:495: Inverse(0): 10011 preimages in 3.822291ms
    iprf_performance_benchmark_test.go:495: Inverse(1): 10043 preimages in 711.875µs
    iprf_performance_benchmark_test.go:495: Inverse(2): 10048 preimages in 699.291µs
    iprf_performance_benchmark_test.go:495: Inverse(3): 10196 preimages in 723.333µs
    iprf_performance_benchmark_test.go:495: Inverse(4): 10018 preimages in 699.917µs
    iprf_performance_benchmark_test.go:495: Inverse(5): 9996 preimages in 710.417µs
    iprf_performance_benchmark_test.go:495: Inverse(6): 9862 preimages in 708.625µs
    iprf_performance_benchmark_test.go:495: Inverse(7): 9984 preimages in 729.25µs
    iprf_performance_benchmark_test.go:495: Inverse(8): 9846 preimages in 712.458µs
    iprf_performance_benchmark_test.go:495: Inverse(9): 9996 preimages in 731.666µs
    iprf_performance_benchmark_test.go:498: Max inverse time with skewed distribution: 3.822291ms
--- PASS: TestWorstCasePerformance (0.01s)
    --- PASS: TestWorstCasePerformance/smallest_range_m=1 (0.00s)
    --- PASS: TestWorstCasePerformance/highly_skewed_distribution (0.01s)
=== RUN   TestPMNSCorrectness
=== RUN   TestPMNSCorrectness/small_equal
=== RUN   TestPMNSCorrectness/small_equal/forward-inverse_round_trip
=== RUN   TestPMNSCorrectness/small_equal/no_element_in_wrong_bin
=== RUN   TestPMNSCorrectness/small_equal/total_coverage
=== RUN   TestPMNSCorrectness/medium_skewed
=== RUN   TestPMNSCorrectness/medium_skewed/forward-inverse_round_trip
=== RUN   TestPMNSCorrectness/medium_skewed/no_element_in_wrong_bin
=== RUN   TestPMNSCorrectness/medium_skewed/total_coverage
=== RUN   TestPMNSCorrectness/large_skewed
=== RUN   TestPMNSCorrectness/large_skewed/forward-inverse_round_trip
=== RUN   TestPMNSCorrectness/large_skewed/no_element_in_wrong_bin
=== RUN   TestPMNSCorrectness/large_skewed/total_coverage
=== RUN   TestPMNSCorrectness/realistic_scale
=== RUN   TestPMNSCorrectness/realistic_scale/forward-inverse_round_trip
=== RUN   TestPMNSCorrectness/realistic_scale/no_element_in_wrong_bin
=== RUN   TestPMNSCorrectness/realistic_scale/total_coverage
--- PASS: TestPMNSCorrectness (0.03s)
    --- PASS: TestPMNSCorrectness/small_equal (0.00s)
        --- PASS: TestPMNSCorrectness/small_equal/forward-inverse_round_trip (0.00s)
        --- PASS: TestPMNSCorrectness/small_equal/no_element_in_wrong_bin (0.00s)
        --- PASS: TestPMNSCorrectness/small_equal/total_coverage (0.00s)
    --- PASS: TestPMNSCorrectness/medium_skewed (0.00s)
        --- PASS: TestPMNSCorrectness/medium_skewed/forward-inverse_round_trip (0.00s)
        --- PASS: TestPMNSCorrectness/medium_skewed/no_element_in_wrong_bin (0.00s)
        --- PASS: TestPMNSCorrectness/medium_skewed/total_coverage (0.00s)
    --- PASS: TestPMNSCorrectness/large_skewed (0.01s)
        --- PASS: TestPMNSCorrectness/large_skewed/forward-inverse_round_trip (0.00s)
        --- PASS: TestPMNSCorrectness/large_skewed/no_element_in_wrong_bin (0.01s)
        --- PASS: TestPMNSCorrectness/large_skewed/total_coverage (0.00s)
    --- PASS: TestPMNSCorrectness/realistic_scale (0.01s)
        --- PASS: TestPMNSCorrectness/realistic_scale/forward-inverse_round_trip (0.00s)
        --- PASS: TestPMNSCorrectness/realistic_scale/no_element_in_wrong_bin (0.01s)
        --- PASS: TestPMNSCorrectness/realistic_scale/total_coverage (0.00s)
=== RUN   TestNodeEncodingUniqueness
=== RUN   TestNodeEncodingUniqueness/determinism
=== RUN   TestNodeEncodingUniqueness/no_collisions_small_values
=== RUN   TestNodeEncodingUniqueness/no_collisions_large_values
=== RUN   TestNodeEncodingUniqueness/encoding_properties
=== RUN   TestNodeEncodingUniqueness/collision_probability_estimate
--- PASS: TestNodeEncodingUniqueness (0.00s)
    --- PASS: TestNodeEncodingUniqueness/determinism (0.00s)
    --- PASS: TestNodeEncodingUniqueness/no_collisions_small_values (0.00s)
    --- PASS: TestNodeEncodingUniqueness/no_collisions_large_values (0.00s)
    --- PASS: TestNodeEncodingUniqueness/encoding_properties (0.00s)
    --- PASS: TestNodeEncodingUniqueness/collision_probability_estimate (0.00s)
=== RUN   TestBinCollectionComplete
=== RUN   TestBinCollectionComplete/small
=== RUN   TestBinCollectionComplete/small/compare_against_brute_force
=== RUN   TestBinCollectionComplete/small/no_duplicate_elements
=== RUN   TestBinCollectionComplete/small/all_elements_covered
=== RUN   TestBinCollectionComplete/medium
=== RUN   TestBinCollectionComplete/medium/compare_against_brute_force
=== RUN   TestBinCollectionComplete/medium/no_duplicate_elements
=== RUN   TestBinCollectionComplete/medium/all_elements_covered
=== RUN   TestBinCollectionComplete/large
=== RUN   TestBinCollectionComplete/large/compare_against_brute_force
=== RUN   TestBinCollectionComplete/large/no_duplicate_elements
=== RUN   TestBinCollectionComplete/large/all_elements_covered
--- PASS: TestBinCollectionComplete (0.02s)
    --- PASS: TestBinCollectionComplete/small (0.00s)
        --- PASS: TestBinCollectionComplete/small/compare_against_brute_force (0.00s)
        --- PASS: TestBinCollectionComplete/small/no_duplicate_elements (0.00s)
        --- PASS: TestBinCollectionComplete/small/all_elements_covered (0.00s)
    --- PASS: TestBinCollectionComplete/medium (0.00s)
        --- PASS: TestBinCollectionComplete/medium/compare_against_brute_force (0.00s)
        --- PASS: TestBinCollectionComplete/medium/no_duplicate_elements (0.00s)
        --- PASS: TestBinCollectionComplete/medium/all_elements_covered (0.00s)
    --- PASS: TestBinCollectionComplete/large (0.02s)
        --- PASS: TestBinCollectionComplete/large/compare_against_brute_force (0.01s)
        --- PASS: TestBinCollectionComplete/large/no_duplicate_elements (0.00s)
        --- PASS: TestBinCollectionComplete/large/all_elements_covered (0.00s)
=== RUN   TestPMNSDistribution
=== RUN   TestPMNSDistribution/binomial_distribution_shape
    iprf_pmns_test.go:461: Distribution: mean=100.00 (expected=100.00), stddev=10.58
    iprf_pmns_test.go:475: Stddev: actual=10.58, expected~0.99
=== RUN   TestPMNSDistribution/chi-squared_test
    iprf_pmns_test.go:506: Chi-squared: 111.92 (df=99, z-score=0.92)
=== RUN   TestPMNSDistribution/no_empty_bins
--- PASS: TestPMNSDistribution (0.02s)
    --- PASS: TestPMNSDistribution/binomial_distribution_shape (0.01s)
    --- PASS: TestPMNSDistribution/chi-squared_test (0.01s)
    --- PASS: TestPMNSDistribution/no_empty_bins (0.01s)
=== RUN   TestPMNSTreeStructure
=== RUN   TestPMNSTreeStructure/tree_depth_correct
=== RUN   TestPMNSTreeStructure/binary_splits_are_consistent
    iprf_pmns_test.go:566: Root split: left=532, right=468, total=1000
--- PASS: TestPMNSTreeStructure (0.00s)
    --- PASS: TestPMNSTreeStructure/tree_depth_correct (0.00s)
    --- PASS: TestPMNSTreeStructure/binary_splits_are_consistent (0.00s)
=== RUN   TestBinomialInverseCDF
=== RUN   TestBinomialInverseCDF/edge_cases
    iprf_pmns_test.go:596: binomialInverseCDF(n=100, p=0.5, u=1) = 89, expected 100
=== RUN   TestBinomialInverseCDF/monotonicity
=== RUN   TestBinomialInverseCDF/range_bounds
--- FAIL: TestBinomialInverseCDF (0.00s)
    --- FAIL: TestBinomialInverseCDF/edge_cases (0.00s)
    --- PASS: TestBinomialInverseCDF/monotonicity (0.00s)
    --- PASS: TestBinomialInverseCDF/range_bounds (0.00s)
=== RUN   TestPRPBijection
=== RUN   TestPRPBijection/tiny_domain
=== RUN   TestPRPBijection/tiny_domain/inverse_property
=== RUN   TestPRPBijection/tiny_domain/no_collisions
=== RUN   TestPRPBijection/tiny_domain/surjection
=== RUN   TestPRPBijection/tiny_domain/determinism
=== RUN   TestPRPBijection/small_domain
=== RUN   TestPRPBijection/small_domain/inverse_property
=== RUN   TestPRPBijection/small_domain/no_collisions
=== RUN   TestPRPBijection/small_domain/surjection
=== RUN   TestPRPBijection/small_domain/determinism
=== RUN   TestPRPBijection/medium_domain
=== RUN   TestPRPBijection/medium_domain/inverse_property
=== RUN   TestPRPBijection/medium_domain/no_collisions
=== RUN   TestPRPBijection/medium_domain/surjection
=== RUN   TestPRPBijection/medium_domain/determinism
=== RUN   TestPRPBijection/large_domain
=== RUN   TestPRPBijection/large_domain/inverse_property
=== RUN   TestPRPBijection/large_domain/no_collisions
=== RUN   TestPRPBijection/large_domain/surjection
=== RUN   TestPRPBijection/large_domain/determinism
--- PASS: TestPRPBijection (0.00s)
    --- PASS: TestPRPBijection/tiny_domain (0.00s)
        --- PASS: TestPRPBijection/tiny_domain/inverse_property (0.00s)
        --- PASS: TestPRPBijection/tiny_domain/no_collisions (0.00s)
        --- PASS: TestPRPBijection/tiny_domain/surjection (0.00s)
        --- PASS: TestPRPBijection/tiny_domain/determinism (0.00s)
    --- PASS: TestPRPBijection/small_domain (0.00s)
        --- PASS: TestPRPBijection/small_domain/inverse_property (0.00s)
        --- PASS: TestPRPBijection/small_domain/no_collisions (0.00s)
        --- PASS: TestPRPBijection/small_domain/surjection (0.00s)
        --- PASS: TestPRPBijection/small_domain/determinism (0.00s)
    --- PASS: TestPRPBijection/medium_domain (0.00s)
        --- PASS: TestPRPBijection/medium_domain/inverse_property (0.00s)
        --- PASS: TestPRPBijection/medium_domain/no_collisions (0.00s)
        --- PASS: TestPRPBijection/medium_domain/surjection (0.00s)
        --- PASS: TestPRPBijection/medium_domain/determinism (0.00s)
    --- PASS: TestPRPBijection/large_domain (0.00s)
        --- PASS: TestPRPBijection/large_domain/inverse_property (0.00s)
        --- PASS: TestPRPBijection/large_domain/no_collisions (0.00s)
        --- PASS: TestPRPBijection/large_domain/surjection (0.00s)
        --- PASS: TestPRPBijection/large_domain/determinism (0.00s)
=== RUN   TestPRPInverseCorrectness
=== RUN   TestPRPInverseCorrectness/inverse_finds_correct_preimage
=== RUN   TestPRPInverseCorrectness/distinguishes_zero_from_not-found
--- PASS: TestPRPInverseCorrectness (0.00s)
    --- PASS: TestPRPInverseCorrectness/inverse_finds_correct_preimage (0.00s)
    --- PASS: TestPRPInverseCorrectness/distinguishes_zero_from_not-found (0.00s)
=== RUN   TestPRPPerformanceReasonable
=== RUN   TestPRPPerformanceReasonable/small_n=1K
    iprf_prp_test.go:190: PRP inverse completed for n=1000
=== RUN   TestPRPPerformanceReasonable/medium_n=10K
    iprf_prp_test.go:190: PRP inverse completed for n=10000
=== RUN   TestPRPPerformanceReasonable/large_n=100K
    iprf_prp_test.go:190: PRP inverse completed for n=100000
=== RUN   TestPRPPerformanceReasonable/realistic_n=8.4M
    iprf_prp_test.go:190: PRP inverse completed for n=8400000
--- PASS: TestPRPPerformanceReasonable (0.48s)
    --- PASS: TestPRPPerformanceReasonable/small_n=1K (0.00s)
    --- PASS: TestPRPPerformanceReasonable/medium_n=10K (0.00s)
    --- PASS: TestPRPPerformanceReasonable/large_n=100K (0.00s)
    --- PASS: TestPRPPerformanceReasonable/realistic_n=8.4M (0.48s)
=== RUN   TestGetDistributionStatsEmptyHandling
=== RUN   TestGetDistributionStatsEmptyHandling/empty_domain
=== RUN   TestGetDistributionStatsEmptyHandling/no_preimages_for_output
=== RUN   TestGetDistributionStatsEmptyHandling/range_larger_than_domain
--- PASS: TestGetDistributionStatsEmptyHandling (0.00s)
    --- PASS: TestGetDistributionStatsEmptyHandling/empty_domain (0.00s)
    --- PASS: TestGetDistributionStatsEmptyHandling/no_preimages_for_output (0.00s)
    --- PASS: TestGetDistributionStatsEmptyHandling/range_larger_than_domain (0.00s)
=== RUN   TestPRPEdgeCases
=== RUN   TestPRPEdgeCases/n=1_domain
=== RUN   TestPRPEdgeCases/n=2_domain
=== RUN   TestPRPEdgeCases/power_of_2_domains
--- PASS: TestPRPEdgeCases (0.00s)
    --- PASS: TestPRPEdgeCases/n=1_domain (0.00s)
    --- PASS: TestPRPEdgeCases/n=2_domain (0.00s)
    --- PASS: TestPRPEdgeCases/power_of_2_domains (0.00s)
=== RUN   TestPRPConsistencyAcrossDomains
=== RUN   TestPRPConsistencyAcrossDomains/different_keys_produce_different_permutations
=== RUN   TestPRPConsistencyAcrossDomains/same_key_same_domain_is_deterministic
--- PASS: TestPRPConsistencyAcrossDomains (0.00s)
    --- PASS: TestPRPConsistencyAcrossDomains/different_keys_produce_different_permutations (0.00s)
    --- PASS: TestPRPConsistencyAcrossDomains/same_key_same_domain_is_deterministic (0.00s)
=== RUN   TestPRPSecurityProperties
=== RUN   TestPRPSecurityProperties/avalanche_effect
=== RUN   TestPRPSecurityProperties/uniform_distribution
--- PASS: TestPRPSecurityProperties (0.00s)
    --- PASS: TestPRPSecurityProperties/avalanche_effect (0.00s)
    --- PASS: TestPRPSecurityProperties/uniform_distribution (0.00s)
=== RUN   TestIPRFForwardBackward
--- PASS: TestIPRFForwardBackward (0.00s)
=== RUN   TestIPRFDistribution
--- PASS: TestIPRFDistribution (0.01s)
=== RUN   TestIPRFInverseCorrectness
--- PASS: TestIPRFInverseCorrectness (0.00s)
=== RUN   TestIPRFDeterminism
--- PASS: TestIPRFDeterminism (0.00s)
=== RUN   TestPRPPermutation
--- PASS: TestPRPPermutation (0.00s)
=== RUN   TestPerformance
=== RUN   TestPerformance/Forward
    iprf_test.go:247: Forward: 485.697µs per operation
    iprf_test.go:251: Forward too slow: 485.697µs (expected microseconds)
=== RUN   TestPerformance/Inverse
    iprf_test.go:264: Inverse: 556.555µs per operation (avg preimage size: 8204.0)
--- FAIL: TestPerformance (0.54s)
    --- FAIL: TestPerformance/Forward (0.49s)
    --- PASS: TestPerformance/Inverse (0.06s)
=== RUN   TestSecurityProperties
    iprf_test.go:299: Duplicate output detected: 3 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 2 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 42 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 91 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 66 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 88 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 11 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 99 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 3 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 0 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 61 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 67 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 25 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 66 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 70 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 8 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 2 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 68 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 8 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 76 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 91 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 93 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 0 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 66 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 50 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 67 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 25 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 57 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 17 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 69 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 97 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 11 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 67 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 97 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 51 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 19 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 38 (indicates potential pattern)
    iprf_test.go:299: Duplicate output detected: 48 (indicates potential pattern)
    iprf_test.go:320: Poor avalanche effect: 5 bits differ between outputs of 1234 and 1235
--- FAIL: TestSecurityProperties (0.00s)
=== RUN   TestIntegration
    iprf_test.go:378: Integration test passed: Enhanced iPRF ready for production use
--- PASS: TestIntegration (0.48s)
=== RUN   TestInversePerformance
=== RUN   TestInversePerformance/Size_1000

Testing with database size: 1000, range: 100
  Output 0: Optimized=9 (2625.00ns), Brute=9 (1049542.00ns), Speedup=399.83x
  Output 99: Optimized=6 (1375.00ns), Brute=6 (1047291.00ns), Speedup=761.67x
=== RUN   TestInversePerformance/Size_10000

Testing with database size: 10000, range: 1000
  Output 0: Optimized=14 (2125.00ns), Brute=14 (13899458.00ns), Speedup=6540.92x
  Output 999: Optimized=12 (1959.00ns), Brute=12 (13975667.00ns), Speedup=7134.08x
=== RUN   TestInversePerformance/Size_100000

Testing with database size: 100000, range: 10000
  Output 0: Optimized=16 (2958.00ns), Brute=16 (177335000.00ns), Speedup=59950.98x
  Output 9999: Optimized=9 (2625.00ns), Brute=9 (180930708.00ns), Speedup=68925.98x
--- PASS: TestInversePerformance (0.39s)
    --- PASS: TestInversePerformance/Size_1000 (0.00s)
    --- PASS: TestInversePerformance/Size_10000 (0.03s)
    --- PASS: TestInversePerformance/Size_100000 (0.36s)
=== RUN   TestInverseCorrectness
✅ Inverse correctness verified for all 1000 possible outputs
--- PASS: TestInverseCorrectness (0.02s)
=== RUN   TestTablePRPBijection
=== RUN   TestTablePRPBijection/tiny_domain_n=10
=== RUN   TestTablePRPBijection/tiny_domain_n=10/no_collisions_-_forward_is_injective
=== RUN   TestTablePRPBijection/tiny_domain_n=10/surjective_-_all_values_reachable
=== RUN   TestTablePRPBijection/tiny_domain_n=10/inverse_property_-_Inverse(Forward(x))_=_x
=== RUN   TestTablePRPBijection/tiny_domain_n=10/forward_property_-_Forward(Inverse(y))_=_y
=== RUN   TestTablePRPBijection/small_domain_n=100
=== RUN   TestTablePRPBijection/small_domain_n=100/no_collisions_-_forward_is_injective
=== RUN   TestTablePRPBijection/small_domain_n=100/surjective_-_all_values_reachable
=== RUN   TestTablePRPBijection/small_domain_n=100/inverse_property_-_Inverse(Forward(x))_=_x
=== RUN   TestTablePRPBijection/small_domain_n=100/forward_property_-_Forward(Inverse(y))_=_y
=== RUN   TestTablePRPBijection/medium_domain_n=1000
=== RUN   TestTablePRPBijection/medium_domain_n=1000/no_collisions_-_forward_is_injective
=== RUN   TestTablePRPBijection/medium_domain_n=1000/surjective_-_all_values_reachable
=== RUN   TestTablePRPBijection/medium_domain_n=1000/inverse_property_-_Inverse(Forward(x))_=_x
=== RUN   TestTablePRPBijection/medium_domain_n=1000/forward_property_-_Forward(Inverse(y))_=_y
=== RUN   TestTablePRPBijection/large_domain_n=10000
=== RUN   TestTablePRPBijection/large_domain_n=10000/no_collisions_-_forward_is_injective
=== RUN   TestTablePRPBijection/large_domain_n=10000/surjective_-_all_values_reachable
=== RUN   TestTablePRPBijection/large_domain_n=10000/inverse_property_-_Inverse(Forward(x))_=_x
=== RUN   TestTablePRPBijection/large_domain_n=10000/forward_property_-_Forward(Inverse(y))_=_y
--- PASS: TestTablePRPBijection (0.00s)
    --- PASS: TestTablePRPBijection/tiny_domain_n=10 (0.00s)
        --- PASS: TestTablePRPBijection/tiny_domain_n=10/no_collisions_-_forward_is_injective (0.00s)
        --- PASS: TestTablePRPBijection/tiny_domain_n=10/surjective_-_all_values_reachable (0.00s)
        --- PASS: TestTablePRPBijection/tiny_domain_n=10/inverse_property_-_Inverse(Forward(x))_=_x (0.00s)
        --- PASS: TestTablePRPBijection/tiny_domain_n=10/forward_property_-_Forward(Inverse(y))_=_y (0.00s)
    --- PASS: TestTablePRPBijection/small_domain_n=100 (0.00s)
        --- PASS: TestTablePRPBijection/small_domain_n=100/no_collisions_-_forward_is_injective (0.00s)
        --- PASS: TestTablePRPBijection/small_domain_n=100/surjective_-_all_values_reachable (0.00s)
        --- PASS: TestTablePRPBijection/small_domain_n=100/inverse_property_-_Inverse(Forward(x))_=_x (0.00s)
        --- PASS: TestTablePRPBijection/small_domain_n=100/forward_property_-_Forward(Inverse(y))_=_y (0.00s)
    --- PASS: TestTablePRPBijection/medium_domain_n=1000 (0.00s)
        --- PASS: TestTablePRPBijection/medium_domain_n=1000/no_collisions_-_forward_is_injective (0.00s)
        --- PASS: TestTablePRPBijection/medium_domain_n=1000/surjective_-_all_values_reachable (0.00s)
        --- PASS: TestTablePRPBijection/medium_domain_n=1000/inverse_property_-_Inverse(Forward(x))_=_x (0.00s)
        --- PASS: TestTablePRPBijection/medium_domain_n=1000/forward_property_-_Forward(Inverse(y))_=_y (0.00s)
    --- PASS: TestTablePRPBijection/large_domain_n=10000 (0.00s)
        --- PASS: TestTablePRPBijection/large_domain_n=10000/no_collisions_-_forward_is_injective (0.00s)
        --- PASS: TestTablePRPBijection/large_domain_n=10000/surjective_-_all_values_reachable (0.00s)
        --- PASS: TestTablePRPBijection/large_domain_n=10000/inverse_property_-_Inverse(Forward(x))_=_x (0.00s)
        --- PASS: TestTablePRPBijection/large_domain_n=10000/forward_property_-_Forward(Inverse(y))_=_y (0.00s)
=== RUN   TestTablePRPDeterminism
=== RUN   TestTablePRPDeterminism/same_forward_outputs
=== RUN   TestTablePRPDeterminism/same_inverse_outputs
--- PASS: TestTablePRPDeterminism (0.00s)
    --- PASS: TestTablePRPDeterminism/same_forward_outputs (0.00s)
    --- PASS: TestTablePRPDeterminism/same_inverse_outputs (0.00s)
=== RUN   TestTablePRPDifferentKeys
    table_prp_test.go:156: Different keys produced 1000/1000 different outputs (100.0%)
--- PASS: TestTablePRPDifferentKeys (0.00s)
=== RUN   TestTablePRPBoundaryConditions
=== RUN   TestTablePRPBoundaryConditions/n=1_domain
=== RUN   TestTablePRPBoundaryConditions/n=2_domain
=== RUN   TestTablePRPBoundaryConditions/out_of_bounds_panics
=== RUN   TestTablePRPBoundaryConditions/inverse_out_of_bounds_panics
--- PASS: TestTablePRPBoundaryConditions (0.00s)
    --- PASS: TestTablePRPBoundaryConditions/n=1_domain (0.00s)
    --- PASS: TestTablePRPBoundaryConditions/n=2_domain (0.00s)
    --- PASS: TestTablePRPBoundaryConditions/out_of_bounds_panics (0.00s)
    --- PASS: TestTablePRPBoundaryConditions/inverse_out_of_bounds_panics (0.00s)
=== RUN   TestTablePRPZeroEdgeCase
=== RUN   TestTablePRPZeroEdgeCase/Inverse(0)_returns_correct_x
=== RUN   TestTablePRPZeroEdgeCase/handles_x=0_correctly_when_it_maps_to_0
    table_prp_test.go:256: For this key, x=81 maps to y=0 (not x=0)
--- PASS: TestTablePRPZeroEdgeCase (0.00s)
    --- PASS: TestTablePRPZeroEdgeCase/Inverse(0)_returns_correct_x (0.00s)
    --- PASS: TestTablePRPZeroEdgeCase/handles_x=0_correctly_when_it_maps_to_0 (0.00s)
=== RUN   TestTablePRPMemoryFootprint
=== RUN   TestTablePRPMemoryFootprint/n=1M
    table_prp_test.go:375: Domain: 1000000 elements
    table_prp_test.go:376: Memory used: 15.26 MB
    table_prp_test.go:377: Memory per element: 16.00 bytes
=== RUN   TestTablePRPMemoryFootprint/n=8.4M
    table_prp_test.go:375: Domain: 8400000 elements
    table_prp_test.go:376: Memory used: 128.18 MB
    table_prp_test.go:377: Memory per element: 16.00 bytes
--- PASS: TestTablePRPMemoryFootprint (0.52s)
    --- PASS: TestTablePRPMemoryFootprint/n=1M (0.04s)
    --- PASS: TestTablePRPMemoryFootprint/n=8.4M (0.48s)
=== RUN   TestTablePRPRealisticScale
    table_prp_test.go:409: Creating TablePRP for n=8400000 (Plinko production scale)
    table_prp_test.go:414: TablePRP initialized successfully
    table_prp_test.go:428: Verified 1000 forward/inverse pairs at production scale
--- PASS: TestTablePRPRealisticScale (0.49s)
=== RUN   TestDeterministicRNG
=== RUN   TestDeterministicRNG/deterministic_output
=== RUN   TestDeterministicRNG/Uint64N_uniform_distribution
=== RUN   TestDeterministicRNG/Uint64N_edge_cases
--- PASS: TestDeterministicRNG (0.00s)
    --- PASS: TestDeterministicRNG/deterministic_output (0.00s)
    --- PASS: TestDeterministicRNG/Uint64N_uniform_distribution (0.00s)
    --- PASS: TestDeterministicRNG/Uint64N_edge_cases (0.00s)
FAIL
FAIL	state-syncer	6.322s
FAIL
